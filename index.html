<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snack Restaurant Le Délice | Tarfaya</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: '#000000',
                        primary: '#FF0000',    /* أحمر */
                        secondary: '#FFD700',  /* أصفر */
                        accent: '#FFFFFF',     /* أبيض */
                    },
                    fontFamily: { sans: ['Poppins', 'sans-serif'] }
                }
            }
        }
    </script>
    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        body {
            background-color: #000000;
            color: #fff;
            overflow-x: hidden;
        }

        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 1rem;
        }

        /* Modal Image Zoom */
        #image-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            cursor: zoom-out;
        }

        #image-overlay img {
            max-width: 90%;
            max-height: 90%;
            border: 4px solid #FFD700;
            border-radius: 10px;
        }

        /* Square Menu Cards */
        .menu-card {
            aspect-ratio: 1 / 1;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .menu-card:hover { transform: scale(1.03); }
        .menu-card img { width: 100%; height: 100%; object-cover: cover; }

        body.modal-open { overflow: hidden; }
        .modal-hide { opacity: 0 !important; transform: scale(1.1) !important; pointer-events: none; }

        .fade-in { opacity: 0; transform: translateY(20px); transition: all 0.6s ease-out; }
        .fade-in.visible { opacity: 1; transform: translateY(0); }

        /* Custom Table Style */
        .visitor-table {
            background-color: #000000 !important;
            color: #FFFFFF !important;
            border: 1px solid #333;
        }
        .visitor-table th { color: #FFD700; border-bottom: 2px solid #FF0000; }
        .visitor-table td { border-bottom: 1px solid #222; }
    </style>
</head>
<body class="modal-open relative antialiased">

    <div id="image-overlay" onclick="this.style.display='none'">
        <img id="overlay-img" src="" alt="Zoom">
    </div>

    <div id="registration-modal" class="fixed inset-0 z-[9999] flex items-center justify-center bg-black/95 backdrop-blur-xl opacity-100 transform scale-100">
        <div class="glass p-10 w-[90%] max-w-md text-center border-primary shadow-2xl">
            <h2 class="text-3xl font-bold mb-2 text-secondary">Bienvenue!</h2>
            <p class="text-white mb-8 text-sm">Veuillez vous enregistrer pour accéder au site.</p>
            <form id="reg-form" class="flex flex-col gap-4">
                <input type="text" id="fname" placeholder="Prénom" required class="w-full bg-white/10 border border-white/20 rounded-lg p-3 text-white focus:border-secondary outline-none">
                <input type="text" id="lname" placeholder="Nom" required class="w-full bg-white/10 border border-white/20 rounded-lg p-3 text-white focus:border-secondary outline-none">
                <button type="submit" class="mt-4 bg-primary hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition-all transform hover:scale-105">
                    Entrer au Restaurant
                </button>
            </form>
        </div>
    </div>

    <nav id="navbar" class="fixed w-full z-50 py-4 bg-black/80 backdrop-blur-md border-b border-primary/30">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <div class="text-2xl font-bold tracking-wider text-white">Le <span class="text-primary">Délice</span></div>
            <div class="hidden md:flex gap-8 font-semibold">
                <a href="#hero" class="hover:text-secondary text-white transition-colors">Accueil</a>
                <a href="#menu" class="hover:text-secondary text-white transition-colors">Menu</a>
                <a href="#visitors" class="hover:text-secondary text-white transition-colors">Visiteurs</a>
            </div>
            <a href="tel:+212655628685" class="bg-secondary text-black px-4 py-2 rounded-full font-bold text-sm hover:bg-white transition-colors">
                +212 655 628 685
            </a>
        </div>
    </nav>

    <section id="hero" class="relative min-h-screen flex items-center justify-center pt-20">
        <div class="absolute inset-0 bg-gradient-to-b from-red-900/20 to-black"></div>
        <div class="relative z-10 text-center px-4 max-w-4xl mx-auto fade-in">
            <h1 class="text-5xl md:text-7xl font-bold mb-6 text-white">
                Snack Restaurant <br>
                <span id="typing-text" class="text-secondary"></span>
            </h1>
            <p class="text-lg text-gray-300 mb-10 uppercase tracking-widest">Tarfaya - Fast Food & Plats Locaux</p>
            <a href="#menu" class="bg-primary text-white font-bold py-4 px-10 rounded-full shadow-lg hover:bg-white hover:text-primary transition-all">
                Découvrir le Menu
            </a>
        </div>
    </section>

    <section id="menu" class="py-24 relative z-10 bg-black">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold mb-4 text-white">Notre <span class="text-primary">Menu</span></h2>
                <div class="w-20 h-1 bg-secondary mx-auto rounded"></div>
            </div>

            <div class="flex flex-wrap justify-center gap-3 mb-12 fade-in" id="menu-tabs"></div>

            <div id="menu-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
                </div>
        </div>
    </section>

    <section id="visitors" class="py-24 bg-black relative z-10">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold mb-4 text-white">Liste des <span class="text-secondary">Visiteurs</span></h2>
                <p class="text-gray-400">Dernières 24 Heures</p>
            </div>

            <div class="max-w-5xl mx-auto overflow-hidden rounded-xl border border-zinc-800 fade-in">
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse visitor-table">
                        <thead>
                            <tr class="bg-zinc-900">
                                <th class="p-4 font-semibold">Prénom</th>
                                <th class="p-4 font-semibold">Nom</th>
                                <th class="p-4 font-semibold">Date</th>
                                <th class="p-4 font-semibold">Heure</th>
                            </tr>
                        </thead>
                        <tbody id="visitor-list"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <footer class="py-8 text-center border-t border-zinc-800 bg-black">
        <p class="text-gray-500">© 2026 Snack Restaurant Le Délice. Tarfaya, Morocco.</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp, query, where, onSnapshot, orderBy, Timestamp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

        const firebaseConfig = {
          apiKey: "AIzaSyDb2A9KAdKtPA34IImq4GWmzUwCkKOXwNk",
          authDomain: "vlymax.firebaseapp.com",
          projectId: "vlymax",
          storageBucket: "vlymax.firebasestorage.app",
          messagingSenderId: "825269785341",
          appId: "1:825269785341:web:97a87c543e31972d94e494"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- MENU DATA ---
        const menuData = [
            { cat: 'PLAT', name: 'Un quart de poulet', img: 'https://i.postimg.cc/tRnnhyz8/cuisses-de-poulet-a-la-portugaise.jpg' },
            { cat: 'PLAT', name: 'Un demi poulet', img: 'https://i.postimg.cc/ZRvHRStF/e1f6f1866aa0a6e03ddca1142299eb11.jpg' },
            { cat: 'PLAT', name: 'Poulet entier', img: 'https://i.postimg.cc/15mF7QCW/ba99189c664b0fcb00096921f3058fe7.jpg' },
            { cat: 'PLAT', name: 'Plat viande Hachée', img: 'https://i.postimg.cc/d1QvP4bM/bfa79fb03b876fcae15d25027092e416.jpg' },
            { cat: 'PLAT', name: 'Plat dinde', img: 'https://i.postimg.cc/xjhrtfTp/b010a3bb5961a0e06c7fbff488b1d552.jpg' },
            { cat: 'PLAT', name: 'Plat escalope', img: 'https://i.postimg.cc/7ZMkZMB3/c59da2f6826be3799d71c69a55f0b642.jpg' },
            { cat: 'PLAT', name: 'Plat saucisse', img: 'https://i.postimg.cc/rwpBqXrw/6fab3c2b72b27380e1af24692888c5ee.jpg' },
            { cat: 'PLAT', name: 'Plat mixte', img: 'https://i.postimg.cc/T2gWfh8V/7a6520ae4d2b8386aca14962aaa851c5.jpg' },
            { cat: 'TACOS', name: 'Tacos dinde', img: 'https://i.postimg.cc/5tzfLYSw/8a427b668f2374794d5c965ce8f8ab84.jpg' },
            { cat: 'TACOS', name: 'Tacos viande hachée', img: 'https://i.postimg.cc/KvVXfcjh/54fe0cac26c292cab77fd077dd5cf7bb.jpg' },
            { cat: 'TACOS', name: 'Tacos escalope', img: 'https://i.postimg.cc/g2kDx3dg/56dc2bc7b8cdcb8cd940264003179a90.jpg' },
            { cat: 'TACOS', name: 'Tacos mixte', img: 'https://i.postimg.cc/qq1NShYF/7c16ad2874bff5b81c70eba85695942d.jpg' },
            { cat: 'TACOS', name: 'Tacos charcuterie', img: 'https://i.postimg.cc/vBNRKGh8/15724c6ae1cb8007a5837feb73073c8e.jpg' },
            { cat: 'SALADE', name: 'Salade marocaine', img: 'https://i.postimg.cc/tC1ZNbtc/salade-marocaine-vegetarienne-640x480-1.jpg' },
            { cat: 'SALADE', name: 'Salade nescoise', img: 'https://i.postimg.cc/Yqk9f3vT/bf0052b6e6b41589ea24690cdee5d9b0.jpg' },
            { cat: 'SALADE', name: 'Salade de chef', img: 'https://i.postimg.cc/ncRJjYB2/3714760464ae47708edb4e60559867df.jpg' },
            { cat: 'COSAMIA', name: 'Poulet', img: 'https://i.postimg.cc/2yNxYFhN/02726ff131ba00c262f4be0201e2e948.jpg' },
            { cat: 'COSAMIA', name: 'Viande hachée', img: 'https://i.postimg.cc/2yNxYFhN/02726ff131ba00c262f4be0201e2e948.jpg' },
            { cat: 'COSAMIA', name: 'Mixte', img: 'https://i.postimg.cc/HL7sffmg/In-Shot-20260219-142010797.jpg' },
            { cat: 'COSAMIA', name: 'Charcuterie', img: 'https://i.postimg.cc/pTRbq7X4/In-Shot-20260219-142159962.jpg' },
            { cat: 'SANDWICH', name: 'Sandwich saucisse', img: 'https://i.postimg.cc/PqPscZmQ/6bcaa7b9c933da8ed954d924e2398706.jpg' },
            { cat: 'SANDWICH', name: 'Sandwich poulet', img: 'https://i.postimg.cc/NMXFHLf3/3e0515b662fad4afcc7392c6a107daad.jpg' },
            { cat: 'SANDWICH', name: 'Sandwich escalope', img: 'https://i.postimg.cc/MpXWBXsx/In-Shot-20260219-162338831.jpg' },
            { cat: 'SANDWICH', name: 'Sandwich viande hachée', img: 'https://i.postimg.cc/cJNbSbtp/In-Shot-20260219-162605694.jpg' },
            { cat: 'SANDWICH', name: 'Sandwich thon', img: 'https://i.postimg.cc/J0cbjpzR/6988d0b8c7e799817229c895c2b4604a.jpg' },
            { cat: 'SANDWICH', name: 'Sandwich mixte', img: 'https://i.postimg.cc/90tnzt3T/15dcd891455be9e21401cb0cb14295f8.jpg' },
            { cat: 'PIZZA', name: 'Pizza viande hachée', img: 'https://i.postimg.cc/fWfCtfqP/b8b215a0-2128-497a-ba18-4322298039fb.jpg' },
            { cat: 'PIZZA', name: 'Pizza poulet', img: 'https://i.postimg.cc/65dhJLnv/Pizza-au-poulet-barbecue.jpg' },
            { cat: 'PIZZA', name: 'Pizza fruit de mer', img: 'https://i.postimg.cc/7LczTfSP/pizza-aux-fruits-de-mer.jpg' },
            { cat: 'PIZZA', name: 'Pizza 4 saison', img: 'https://i.postimg.cc/DzgXBxVX/4-saisons-decoupe-mosaique-pizza.jpg' },
            { cat: 'PIZZA', name: 'Pizza marguarita', img: 'https://i.postimg.cc/854xkQq2/ed3fcec7-7994-426d-a5e4-a24be5a95afd-pizza-recipe-main-(1).jpg' },
            { cat: 'PIZZA', name: 'Pizza vegetarian', img: 'https://i.postimg.cc/g2bs7t7M/Vegetarian-Pizza-with-Caramelized-Onions-Mushrooms-Jalapeno-FI.jpg' },
            { cat: 'PIZZA', name: 'Pizza thon', img: 'https://i.postimg.cc/WzFR5Yy4/pizza-thon-creme-fraiche-500x500.jpg' },
            { cat: 'BURGER', name: 'Burger poulet', img: 'https://i.postimg.cc/J7S4mkZN/LUMA-rezept-crispy-chicken-burger-007-1.jpg' },
            { cat: 'BURGER', name: 'Classique Burger', img: 'https://i.postimg.cc/13sS5ctG/i91705-hamburger.jpg' },
            { cat: 'BURGER', name: 'Burger mixte', img: 'https://i.postimg.cc/3wqzpgKP/burger-mixte-boeuf-poulet-pane-double-fromage-cheddar-roquette-mayonnaise-tranches-tomates-frites-44.jpg' },
            { cat: 'SPÉCIAL', name: 'Couscous chaque vendredi', img: 'https://i.postimg.cc/Dy5jLq6d/Couscous-530x-2x-1.jpg' }
        ];

        const categories = ['TOUT', 'PLAT', 'TACOS', 'SALADE', 'COSAMIA', 'SANDWICH', 'PIZZA', 'BURGER', 'SPÉCIAL'];

        // --- FIREBASE LOGIC ---
        const modal = document.getElementById('registration-modal');
        const form = document.getElementById('reg-form');
        const tbody = document.getElementById('visitor-list');

        if (localStorage.getItem('registeredDelice') === 'true') {
            modal.style.display = 'none';
            document.body.classList.remove('modal-open');
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const fname = document.getElementById('fname').value;
            const lname = document.getElementById('lname').value;

            try {
                await addDoc(collection(db, "visitors"), {
                    fname, lname, timestamp: serverTimestamp()
                });
                localStorage.setItem('registeredDelice', 'true');
                modal.classList.add('modal-hide');
                setTimeout(() => {
                    modal.style.display = 'none';
                    document.body.classList.remove('modal-open');
                }, 600);
            } catch (err) { console.error(err); }
        });

        const q = query(
            collection(db, "visitors"),
            where("timestamp", ">=", Timestamp.fromDate(new Date(Date.now() - 24 * 60 * 60 * 1000))),
            orderBy("timestamp", "desc")
        );

        onSnapshot(q, (snapshot) => {
            tbody.innerHTML = '';
            snapshot.forEach(doc => {
                const data = doc.data();
                const date = data.timestamp ? data.timestamp.toDate() : new Date();
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="p-4">${data.fname}</td>
                    <td class="p-4">${data.lname}</td>
                    <td class="p-4">${date.toLocaleDateString('fr-FR')}</td>
                    <td class="p-4">${date.toLocaleTimeString('fr-FR', {hour:'2-digit', minute:'2-digit'})}</td>
                `;
                tbody.appendChild(tr);
            });
        });

        // --- MENU UI ---
        const menuTabs = document.getElementById('menu-tabs');
        const menuGrid = document.getElementById('menu-grid');
        const overlay = document.getElementById('image-overlay');
        const overlayImg = document.getElementById('overlay-img');

        function openImage(src) {
            overlayImg.src = src;
            overlay.style.display = 'flex';
        }

        function renderMenu(filter = 'TOUT') {
            menuGrid.innerHTML = '';
            const filtered = filter === 'TOUT' ? menuData : menuData.filter(i => i.cat === filter);
            
            filtered.forEach(item => {
                const div = document.createElement('div');
                div.className = 'menu-card glass group';
                div.onclick = () => openImage(item.img);
                div.innerHTML = `
                    <img src="${item.img}" alt="${item.name}" loading="lazy">
                    <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-center items-center p-2 text-center">
                        <span class="text-secondary font-bold text-xs uppercase mb-1">${item.cat}</span>
                        <h3 class="text-white text-sm font-semibold">${item.name}</h3>
                        <span class="text-[10px] text-gray-300 mt-2">Cliquer pour agrandir</span>
                    </div>
                `;
                menuGrid.appendChild(div);
            });
        }

        categories.forEach(cat => {
            const btn = document.createElement('button');
            btn.className = `px-4 py-2 rounded-full text-xs font-bold transition-all ${cat === 'TOUT' ? 'bg-primary text-white' : 'bg-zinc-800 text-gray-400'}`;
            btn.textContent = cat;
            btn.onclick = () => {
                document.querySelectorAll('#menu-tabs button').forEach(b => b.className = 'px-4 py-2 rounded-full text-xs font-bold bg-zinc-800 text-gray-400 transition-all');
                btn.className = 'px-4 py-2 rounded-full text-xs font-bold bg-primary text-white transition-all';
                renderMenu(cat);
            };
            menuTabs.appendChild(btn);
        });

        renderMenu();

        // Typing Effect
        let typeIndex = 0;
        const text = "Le Délice";
        function type() {
            if (typeIndex < text.length) {
                document.getElementById('typing-text').textContent += text[typeIndex];
                typeIndex++;
                setTimeout(type, 200);
            }
        }
        type();

        // Fade in observer
        const observer = new IntersectionObserver(entries => {
            entries.forEach(e => { if(e.isIntersecting) e.target.classList.add('visible')});
        }, {threshold: 0.1});
        document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

    </script>
</body>
</html>
